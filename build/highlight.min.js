var Match=function(e,t,n,r,i,a){this.index=e,this.classes=t,this.type=n,this.length=r,this.match=i,this.precedence=a},RegexHighlighter=function(e){this.returnClassName=e,"undefined"==typeof this.returnClassName&&(this.returnClassName="regex-highlight")};RegexHighlighter.prototype.sortArrayByObjectsIndex=function(e){e.sort(function(e,t){return e.index==t.index?e.precedence-t.precedence:e.index-t.index})},RegexHighlighter.prototype.removeDuplicateObjectsFromArray=function(e,t){for(var n=1;n<e.length;n++){var r=t(e[n-1],e[n]);0!=r&&(0>r?(e.splice(n-1,1),n--):(e.splice(n,1),n--))}},RegexHighlighter.prototype.wrapTextWithSpan=function(e,t,n,r){if("undefined"==typeof e)return!1;"undefined"==typeof t&&(t=""),"undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=e.length);var i=e.substring(0,n),a=e.substring(n,r),g=e.substring(r);return i+"<span class='"+t+"'>"+a+"</span>"+g},RegexHighlighter.prototype.getMatchesArrayFromRegex=function(e,t){for(var n=[],r=1,i=0;i<e.length;i++){var a,g=e[i],h=g.type,s=g.regexes;if(g.precedence){if(isNaN(g.precedence)){for(var c=!1,o=0;o<n.length;o++)if(g.precedence==n[o].type){a=n[o].precedence,c=!0;break}c||(a=r)}else a=parseInt(g.precedence);r--}else a=r;for(var o=0;o<s.length;o++){var l,p;"string"==typeof s[o]?(l=s[o],p=0):(l=s[o].regexString,p=s[o].captureGroup);var d=this.findRegexMatches(t,l,p,h,a);n.push.apply(n,d)}r++}return n},RegexHighlighter.prototype.findRegexMatches=function(e,t,n,r,i){for(var a=[],g=new RegExp(t,"gm");match=g.exec(e);){var h=match.index;n>=match.length&&(n=0);var s=match[n],c=match[0].indexOf(s);matchObject=new Match(h+c,this.returnClassName+" "+r,r,s.length,s,i),a.push(matchObject)}return a},RegexHighlighter.prototype.defaultDuplicateFunction=function(e,t){return e.index==t.index?e.precedence==t.precedence?e.length==t.length?-1:e.length-t.length:e.precedence-t.precedence:t.index>e.index&&t.index+t.length<e.index+e.length?1:t.index>e.index&&t.index<e.index+e.length&&t.index+t.length>=e.index+e.length?e.precedence!=t.precedence?e.precedence-t.precedence:e.length!=t.length?e.length-t.length:-1:0},RegexHighlighter.prototype.insertSyntaxHighlighting=function(e,t,n){"undefined"==typeof n&&(n=this.defaultDuplicateFunction);var r=this.getMatchesArrayFromRegex(e,t);return this.sortArrayByObjectsIndex(r),this.removeDuplicateObjectsFromArray(r,n),this.assembleNewStringFromMatchArray(t,r)},RegexHighlighter.prototype.insertSyntaxHighlightingByClass=function(e,t){if("undefined"==typeof e)return!1;"undefined"==typeof t&&(t="regex-color");for(var n=document.getElementsByClassName(t),r=0;r<n.length;r++){var i=n[r],a=i.innerHTML;result=this.insertSyntaxHighlighting(e,a),result&&(i.innerHTML=result)}return!0},RegexHighlighter.prototype.loadSyntaxHighlightingByClass=function(e,t){"undefined"==typeof t&&(t="languages/"),"undefined"==typeof e&&(e="regex-color");for(var n=document.getElementsByClassName(e),r=0;r<n.length;r++){var i=n[r],a=i.className.split(" ");if(a.length>1){var g=a[1];ajaxGET(t+g+".json",function(e,t){var n=JSON.parse(e),r=this.insertSyntaxHighlighting(n,t.innerHTML);r&&(t.innerHTML=r)}.bind(this),i)}}},RegexHighlighter.prototype.assembleNewStringFromMatchArray=function(e,t){for(var n=0,r=0;r<t.length;r++){var i=t[r],a=i.index+n,g=i.classes,h=i.length;e=this.wrapTextWithSpan(e,g,a,a+h),n+=("<span class=''></span>"+g).length}return e},RegexHighlighter.prototype.ajaxGET=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){4==r.readyState&&200==r.status&&t(r.responseText,n)},r.open("GET",e,!0),r.send()};
